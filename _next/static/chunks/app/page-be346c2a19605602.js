(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{104:(e,t,r)=>{"use strict";r.r(t),r.d(t,{RootProvider:()=>n});var s=r(5155),a=r(4540),i=r(5535);let n=e=>{let{children:t}=e;return(0,s.jsx)(a.Kq,{store:i.M,children:t})}},971:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ReviewsList:()=>c});var s=r(5155),a=r(8674),i=r(8601),n=r.n(i);let{useGetReviewsQuery:l}=a.qK.injectEndpoints({endpoints:e=>({getReviews:e.query({query:()=>"reviews"})})}),c=()=>{let{data:e,isLoading:t,error:r}=l();return t?(0,s.jsx)("div",{children:"Загрузка отзывов..."}):r?(0,s.jsx)("div",{children:"Ошибка при загрузке"}):(0,s.jsx)("div",{className:n().list,children:null==e?void 0:e.map(e=>(0,s.jsx)(a.an,{html:e.text},e.id))})}},2164:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5717,23)),Promise.resolve().then(r.bind(r,5595)),Promise.resolve().then(r.bind(r,971)),Promise.resolve().then(r.bind(r,9969))},2654:e=>{e.exports={card:"ProductCard_card__L6Q4e",image:"ProductCard_image__sozlO",content:"ProductCard_content__sB5ZW",title:"ProductCard_title__EQ6kM",description:"ProductCard_description__o9C6D",price:"ProductCard_price__QnnR_",buyButton:"ProductCard_buyButton__2yPoG",counter:"ProductCard_counter__7ESIC"}},3727:e=>{e.exports={cart:"ShoppingCart_cart__WVaR6",title:"ShoppingCart_title__j_TKN",list:"ShoppingCart_list__XbG_F",controls:"ShoppingCart_controls__NK2KO",input:"ShoppingCart_input__KJaZg",error:"ShoppingCart_error__kEG_A",success:"ShoppingCart_success___vOt5"}},3993:e=>{e.exports={grid:"ProductsGallery_grid__G_fdB",loader:"ProductsGallery_loader__YbMz2"}},4830:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var s=r(404),a=r(4317);let i=(0,s.xP)({baseQuery:(0,a.cw)({baseUrl:"/api/",prepareHeaders:e=>(e.set("Content-Type","application/json"),e)}),endpoints:()=>({}),reducerPath:"baseApi"})},5535:(e,t,r)=>{"use strict";r.d(t,{M:()=>n});var s=r(5710),a=r(4317),i=r(4830);let n=(0,s.U1)({reducer:{[i.q.reducerPath]:i.q.reducer},middleware:e=>e().concat(i.q.middleware)});(0,a.$k)(n.dispatch)},5595:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductsGallery:()=>d});var s=r(5155),a=r(2115),i=r(3993),n=r.n(i),l=r(9595),c=r(8674),o=r(9969);let d=()=>{let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)(1),[d,u]=(0,a.useState)(!0),{cart:_,addItem:p,removeItem:h,changeQuantity:g,clearCart:m}=(0,c._$)(),[v,{data:x,isFetching:j}]=(0,l.IU)(),C=(0,a.useRef)(null);return(0,a.useEffect)(()=>{v({page:r,pageSize:20})},[r]),(0,a.useEffect)(()=>{var e;(null==x||null==(e=x.items)?void 0:e.length)&&(t(e=>[...e,...x.items]),x.items.length<20&&u(!1))},[x]),(0,a.useEffect)(()=>{if(!d||j)return;let e=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting&&i(e=>e+1)},{threshold:1});return C.current&&e.observe(C.current),()=>{C.current&&e.unobserve(C.current)}},[d,j]),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.ShoppingCart,{cart:_,products:e,clearCart:m}),(0,s.jsxs)("div",{className:n().grid,children:[e.map(e=>(0,s.jsx)(c.AA,{product:e,quantity:_[e.id]||0,onAdd:()=>p(e.id),onRemove:()=>h(e.id),onChangeQuantity:t=>g(e.id,t)},e.id)),d&&(0,s.jsx)("div",{ref:C,className:n().loader,children:"Загрузка..."})]})]})}},5717:e=>{e.exports={page:"page_page__556_G",main:"page_main__nw1Wk",ctas:"page_ctas__rfsth",primary:"page_primary__2CBMe",secondary:"page_secondary__jzhTV",footer:"page_footer__F3MD0",logo:"page_logo__ikIZE"}},8601:e=>{e.exports={list:"ReviewsList_list__8HMkz"}},8674:(e,t,r)=>{"use strict";r.d(t,{AA:()=>c,an:()=>_,qK:()=>s.q,_$:()=>p}),r(104),r(5535);var s=r(4830),a=r(5155),i=r(2115),n=r(2654),l=r.n(n);let c=e=>{let{product:t,quantity:r=0,onAdd:s,onRemove:n,onChangeQuantity:c}=e,[o,d]=(0,i.useState)(r.toString());return(0,a.jsxs)("div",{className:l().card,children:[(0,a.jsx)("img",{src:t.image_url,alt:t.title,className:l().image}),(0,a.jsxs)("div",{className:l().content,children:[(0,a.jsx)("h3",{className:l().title,children:t.title}),(0,a.jsx)("p",{className:l().description,children:t.description}),(0,a.jsxs)("p",{className:l().price,children:["Цена: ",t.price," ₽"]}),0===r?(0,a.jsx)("button",{className:l().buyButton,onClick:()=>{d("1"),s()},children:"Купить"}):(0,a.jsxs)("div",{className:l().counter,children:[(0,a.jsx)("button",{onClick:()=>{let e=Number(o)-1;d(e.toString()),c(e)},children:"-"}),(0,a.jsx)("input",{type:"text",value:o,onChange:e=>{let t=e.target.value;/^\d*$/.test(t)&&(d(t),c(Number(t||0)))},onBlur:()=>{(""===o||0===Number(o))&&n()}}),(0,a.jsx)("button",{onClick:()=>{let e=Number(o)+1;d(e.toString()),c(e)},children:"+"})]})]})]})};var o=r(822),d=r(9906),u=r.n(d);let _=e=>{let{html:t}=e,r=o.A.sanitize(t);return(0,a.jsx)("div",{className:u().review,dangerouslySetInnerHTML:{__html:r}})},p=()=>{let[e,t]=(0,i.useState)({});(0,i.useEffect)(()=>{let e=localStorage.getItem("cart");e&&t(JSON.parse(e))},[]),(0,i.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(e))},[e]);let r=e=>{t(t=>{let r={...t};return delete r[e],r})};return{cart:e,addItem:e=>{t(t=>({...t,[e]:1}))},removeItem:r,changeQuantity:(e,s)=>{s<=0?r(e):t(t=>({...t,[e]:s}))},clearCart:()=>{t({}),localStorage.removeItem("cart")}}}},9595:(e,t,r)=>{"use strict";r.d(t,{IU:()=>a,zx:()=>i});let{useGetProductsQuery:s,useLazyGetProductsQuery:a,useSendOrderMutation:i}=r(8674).qK.injectEndpoints({endpoints:e=>({getProducts:e.query({query:e=>{let{page:t=1,pageSize:r=20}=e;return"products?page=".concat(t,"&page_size=").concat(r)}}),sendOrder:e.mutation({query:e=>({url:"order",method:"POST",body:e})})})})},9906:e=>{e.exports={review:"ReviewItem_review__tsl_8"}},9969:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ShoppingCart:()=>o});var s=r(5155),a=r(2115),i=r(3727),n=r.n(i),l=r(9595),c=r(5970);let o=e=>{let{cart:t,products:r,clearCart:i}=e,[o,d]=(0,a.useState)(""),[u,_]=(0,a.useState)(!1),[p,{isLoading:h,isSuccess:g}]=(0,l.zx)();(0,a.useEffect)(()=>{let e=localStorage.getItem("phone");e&&d(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("phone",o)},[o]);let m=r.filter(e=>t[e.id]);m.reduce((e,r)=>e+r.price*t[r.id],0);let v=async()=>{let e=o.replace(/\D/g,"");if(e.length<11)return void _(!0);await p({phone:e,cart:Object.entries(t).map(e=>{let[t,r]=e;return{id:Number(t),quantity:r}})})};return(0,a.useEffect)(()=>{g&&(d(""),localStorage.removeItem("phone"),i())},[g]),(0,s.jsxs)("div",{className:n().cart,children:[(0,s.jsx)("h3",{className:n().title,children:"Добавленные товары"}),0!==m.length||g?(0,s.jsx)("ul",{className:n().list,children:m.map(e=>(0,s.jsxs)("li",{children:[e.title," x",t[e.id]," — ",e.price*t[e.id]," ₽"]},e.id))}):(0,s.jsx)("p",{children:"Корзина пуста"}),(0,s.jsxs)("div",{className:n().controls,children:[(0,s.jsx)(c._g,{mask:"+7 (000) 000-00-00",value:o,onAccept:e=>d(e),placeholder:"+7 (___) ___-__-__",className:"".concat(n().input," ").concat(u&&o.replace(/\D/g,"").length<11?n().error:"")}),(0,s.jsx)("button",{onClick:v,disabled:h||0===m.length||o.replace(/\D/g,"").length<11,children:"заказать"})]}),g&&0===m.length&&(0,s.jsx)("div",{className:n().success,children:"Заказ отправлен"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[595,404,167,441,684,358],()=>t(2164)),_N_E=e.O()}]);